<template name="backgroundMap">
    {{#leaflet items=rooms id="room-map" disabled=isDisabled}}
        <div class="marker">
            <div class="marker-pin"></div>
            <img class="flag" src="/kiszaszlo-terkep.png"/>
{{!--             <svg class="flag" width="16px" height="20px" style="position: absolute; top: -20px;">
                <rect x="0.5" width="2" height="19" style="fill: white; stroke: black; stroke-width: 1;"/>
                <polygon points="0,0 0,10 16,10 11,5 16,0" style="fill: {{#if isSelected}}cyan{{else}}black{{/if}};"/>
            </svg> --}}
            <span class="marker-label {{#if isSelected}}selected{{/if}}">{{title}}</span>
        </div>
    {{/leaflet}}

    <aside>
        <div class="panel">
            {{>miniLogin}}
        </div>
        {{#if currentUser}}
            <div id="room-editor" class="panel">
                {{#with selectedItem}}
                    <form id="updateRoom">
                        <input type="text" name="title" value={{this.title}} placeholder="name">
                        <input type="text" name="site" value={{this.site}} placeholder="site url"><a href={{this.site}} target="_blank">go to site</a>
                        <input type="text" name="opened" value={{this.opened}} placeholder="opened">
                        <input type="text" name="closed" value={{this.closed}} placeholder="closed">
                        <button type="submit">update</button>
                    </form>
                    <hr>
                    <form id="updateAddress">
                        <input type="text" name="address" placeholder="address">
                        <button type="submit">move marker</button>
                    </form>
                    <hr>
                    <button class="delete danger">delete</button>
                {{else}}
                    -no selection-
                {{/with}}
                {{#autoForm collection="Rooms" doc=selectedItem id="insertRoomForm" type="update"}}
                    {{>afQuickField name='title'}}
                    {{>afQuickField name='opened'}}
                    {{>afQuickField name='closed'}}
                    {{>afQuickField name='address'}}
                {{/autoForm}}
            </div>
        {{else}}
            {{#with selectedItem}}
            <div class="panel">
                <header>
                    <h3>{{this.title}}</h3>
                    <p>({{this.opened}}-{{this.closed}})</p>
                </header>
                <a href={{this.site}} target="_blank">{{this.site}}</a>
            </div>
            {{/with}}
        {{/if}}
    </aside>

    <div id="timerange">
        {{timeRange.begin}}â€“{{timeRange.end}}
        <div class="slider"></div>
    </div>
</template>